videojs.Youtube=videojs.MediaTechController.extend({init:function(f,c,g){videojs.MediaTechController.call(this,f,c,g);this.features.fullscreenResize=true;this.player_=f;this.player_el_=document.getElementById(this.player_.id());if(typeof c.source!="undefined"){for(var e in c.source){this.player_.options()[e]=c.source[e]}}if(this.player_.options().ytcontrols){this.player_.controls(false)}this.videoId=videojs.Youtube.parseVideoId(this.player_.options().src);if(typeof this.videoId!="undefined"){if(!this.player_.options().ytcontrols){if(typeof this.player_.poster()=="undefined"){this.player_.poster("http://img.youtube.com/vi/"+this.videoId+"/0.jpg")}var b=this;setTimeout(function(){b.player_.posterImage.el().style.backgroundSize="cover"},50)}}this.id_=this.player_.id()+"_youtube_api";this.el_=videojs.Component.prototype.createEl("iframe",{id:this.id_,className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0,webkitAllowFullScreen:"",mozallowfullscreen:"",allowFullScreen:""});this.player_el_.insertBefore(this.el_,this.player_el_.firstChild);var h={enablejsapi:1,iv_load_policy:3,playerapiid:this.id(),disablekb:1,wmode:"transparent",controls:(this.player_.options().ytcontrols)?1:0,showinfo:0,modestbranding:1,rel:0,autoplay:(this.player_.options().autoplay)?1:0,loop:(this.player_.options().loop)?1:0,list:videojs.Youtube.parsePlaylist(this.player_.options().src)};if(typeof h.list=="undefined"){delete h.list}if(this.player_.options().autoplay){this.playOnReady=true}if(window.location.protocol!="file:"){h.origin=window.location.protocol+"//"+window.location.host}this.el_.src="http://www.youtube.com/embed/"+this.videoId+"?"+videojs.Youtube.makeQueryString(h);if(this.player_.options().ytcontrols){var b=this;setTimeout(function(){var j=b.player_.bigPlayButton.el();j.parentNode.removeChild(j);var i=b.player_.controlBar.el();i.parentNode.removeChild(i)},50)}if(videojs.Youtube.apiReady){this.loadYoutube()}else{videojs.Youtube.loadingQueue.push(this);if(!videojs.Youtube.apiLoading){var a=document.createElement("script");a.src="http://www.youtube.com/iframe_api";var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(a,d);videojs.Youtube.apiLoading=true}}}});videojs.Youtube.prototype.dispose=function(){if(this.el_){this.el_.parentNode.removeChild(this.el_)}if(this.ytplayer){this.ytplayer.destroy()}videojs.MediaTechController.prototype.dispose.call(this)};videojs.Youtube.prototype.src=function(a){this.ytplayer.loadVideoById({videoId:videojs.Youtube.parseVideoId(a),list:videojs.Youtube.parsePlaylist(a)})};videojs.Youtube.prototype.play=function(){if(this.isReady_){this.ytplayer.playVideo()}else{this.playOnReady=true}};videojs.Youtube.prototype.pause=function(){this.ytplayer.pauseVideo()};videojs.Youtube.prototype.paused=function(){return this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING};videojs.Youtube.prototype.currentTime=function(){return this.ytplayer.getCurrentTime()};videojs.Youtube.prototype.setCurrentTime=function(a){this.ytplayer.seekTo(a,true);this.player_.trigger("timeupdate")};videojs.Youtube.prototype.duration=function(){return this.ytplayer.getDuration()};videojs.Youtube.prototype.buffered=function(){var a=this.ytplayer.getVideoBytesLoaded();var d=this.ytplayer.getVideoBytesTotal();if(!a||!d){return 0}var e=this.ytplayer.getDuration();var c=(a/d)*e;var b=(this.ytplayer.getVideoStartBytes()/d)*e;return videojs.createTimeRange(b,b+c)};videojs.Youtube.prototype.volume=function(){if(isNaN(this.volumeVal)){this.volumeVal=this.ytplayer.getVolume()/100}return this.volumeVal};videojs.Youtube.prototype.setVolume=function(a){if(a&&a!=this.volumeVal){this.ytplayer.setVolume(a*100);this.volumeVal=a;this.player_.trigger("volumechange")}};videojs.Youtube.prototype.muted=function(){return this.ytplayer.isMuted()};videojs.Youtube.prototype.setMuted=function(b){if(b){this.ytplayer.mute()}else{this.ytplayer.unMute()}var a=this;setTimeout(function(){a.player_.trigger("volumechange")},50)};videojs.Youtube.prototype.onReady=function(){this.isReady_=true;this.player_.trigger("techready");this.triggerReady();this.player_.trigger("durationchange");if(this.playOnReady){this.ytplayer.playVideo()}};videojs.Youtube.prototype.onStateChange=function(a){if(a!=this.lastState){switch(a){case -1:this.player_.trigger("durationchange");break;case YT.PlayerState.ENDED:this.player_.trigger("ended");break;case YT.PlayerState.PLAYING:this.player_.trigger("timeupdate");this.player_.trigger("durationchange");this.player_.trigger("playing");this.player_.trigger("play");break;case YT.PlayerState.PAUSED:this.player_.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate");this.player_.trigger("waiting");break;case YT.PlayerState.CUED:break}this.lastState=a}};videojs.Youtube.prototype.onPlaybackQualityChange=function(a){switch(a){case"medium":this.player_.videoWidth=480;this.player_.videoHeight=360;break;case"large":this.player_.videoWidth=640;this.player_.videoHeight=480;break;case"hd720":this.player_.videoWidth=960;this.player_.videoHeight=720;break;case"hd1080":this.player_.videoWidth=1440;this.player_.videoHeight=1080;break;case"highres":this.player_.videoWidth=1920;this.player_.videoHeight=1080;break;case"small":this.player_.videoWidth=320;this.player_.videoHeight=240;break;default:this.player_.videoWidth=0;this.player_.videoHeight=0;break}this.player_.trigger("ratechange")};videojs.Youtube.prototype.onError=function(a){this.player_.error=a;this.player_.trigger("error")};videojs.Youtube.isSupported=function(){return true};videojs.Youtube.prototype.supportsFullScreen=function(){return false};videojs.Youtube.canPlaySource=function(a){return(a.type=="video/youtube")};videojs.Youtube.loadingQueue=[];videojs.Youtube.prototype.loadYoutube=function(){this.ytplayer=new YT.Player(this.id_,{events:{onReady:function(a){a.target.vjsTech.onReady()},onStateChange:function(a){a.target.vjsTech.onStateChange(a.data)},onPlaybackQualityChange:function(a){a.target.vjsTech.onPlaybackQualityChange(a.data)},onError:function(a){a.target.vjsTech.onError(a.data)}}});this.ytplayer.vjsTech=this};videojs.Youtube.makeQueryString=function(a){var c=[];for(var b in a){if(a.hasOwnProperty(b)){c.push(encodeURIComponent(b)+"="+encodeURIComponent(a[b]))}}return c.join("&")};videojs.Youtube.parseVideoId=function(c){var b=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var a=c.match(b);if(a&&a[2].length==11){return a[2]}};videojs.Youtube.parsePlaylist=function(c){var b=/[?&]list=([^#\&\?]+)/;var a=c.match(b);if(a!=null&&a.length>1){return a[1]}};window.onYouTubeIframeAPIReady=function(){var a;while((a=videojs.Youtube.loadingQueue.shift())){a.loadYoutube()}videojs.Youtube.loadingQueue=[];videojs.Youtube.apiReady=true};